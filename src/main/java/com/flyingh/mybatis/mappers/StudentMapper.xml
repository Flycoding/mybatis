<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper 
	PUBLIC "-//ibatis.apache.org//DTD Mapper 3.0//EN" 
	"http://ibatis.apache.org/dtd/ibatis-3-mapper.dtd">
<mapper namespace="com.flyingh.mybatis.mappers.StudentMapper">
	<resultMap type="Student" id="StudentResult">
		<id property="studId" column="stud_id" />
		<result property="name" column="name" />
		<result property="email" column="email" />
		<result property="dob" column="dob" />
	</resultMap>

	<resultMap type="address" id="AddressResult">
		<id property="addrId" column="addr_id" />
		<result property="city" column="city" />
		<result property="zip" column="zip" />
	</resultMap>

	<resultMap type="Student" id="StudentWithAddressResult"
		extends="StudentResult">
		<association property="address" resultMap="AddressResult"></association>
	</resultMap>

	<select id="findAllWithAddress" resultMap="StudentWithAddressResult">
		select s.*,a.* from
		students s,address a where s.addr_id=a.addr_id
	</select>

	<select id="findStudentWithAddress" parameterType="int"
		resultMap="StudentWithAddressResult">
		select stud_id,name,email,dob,s.addr_id,city,zip from
		students s left outer join address a on s.addr_id=a.addr_id
		where
		stud_id=#{id}
	</select>

	<select id="findAll" resultMap="StudentResult">
		select * from students
	</select>
	<select id="findById" parameterType="int" resultType="Student">
		select
		stud_id as
		studId,name,email,dob from students where stud_id=#{id}
	</select>
	<insert id="insert" parameterType="Student" useGeneratedKeys="true"
		keyProperty="studId">
		insert into
		students(name,email,dob)
		values(#{name},#{email},#{dob})
	</insert>
	<update id="update" parameterType="Student">
		update students set
		name=#{name},email=#{email},dob=#{dob} where stud_id=#{studId}
	</update>
	<delete id="delete" parameterType="int">
		delete from students where
		stud_id=#{studId}
	</delete>

</mapper>